<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-publications docs-version-current docs-doc-page docs-doc-id-technical-papers/continuous-authentication/06 risk-classification" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Risk Classification &amp; Decision Logic | AG</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://eigenbytes.com/img/og-default-compressed.png"><meta data-rh="true" name="twitter:image" content="https://eigenbytes.com/img/og-default-compressed.png"><meta data-rh="true" property="og:url" content="https://eigenbytes.com/publications/technical-papers/continuous-authentication/06 risk-classification"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-publications-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-publications-current"><meta data-rh="true" property="og:title" content="Risk Classification &amp; Decision Logic | AG"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/eigenbytes-favicon-dark.svg" media="(prefers-color-scheme: dark)"><link data-rh="true" rel="icon" href="/img/eigenbytes-favicon.svg"><link data-rh="true" rel="canonical" href="https://eigenbytes.com/publications/technical-papers/continuous-authentication/06 risk-classification"><link data-rh="true" rel="alternate" href="https://eigenbytes.com/publications/technical-papers/continuous-authentication/06 risk-classification" hreflang="en"><link data-rh="true" rel="alternate" href="https://eigenbytes.com/publications/technical-papers/continuous-authentication/06 risk-classification" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Technical Papers","item":"https://eigenbytes.com/publications/technical-papers/"},{"@type":"ListItem","position":2,"name":"Deep Learning–Enabled Multimodal Continuous Authentication","item":"https://eigenbytes.com/publications/technical-papers/continuous-authentication/"},{"@type":"ListItem","position":3,"name":"Risk Classification & Decision Logic","item":"https://eigenbytes.com/publications/technical-papers/continuous-authentication/06 risk-classification"}]}</script><link rel="stylesheet" href="/assets/css/styles.9cfd3060.css">
<script src="/assets/js/runtime~main.bfb843dc.js" defer="defer"></script>
<script src="/assets/js/main.084b6d0a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Home</b></a><a class="navbar__item navbar__link" href="/engineering">Engineering</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/resume">Resume</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/anubhab-codes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><a href="https://www.linkedin.com/in/anubhab-ghosh/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-linkedin-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/publications/"><span title="Publications" class="linkLabel_WmDU">Publications</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/publications/technical-papers/"><span title="Technical Papers" class="categoryLinkLabel_W154">Technical Papers</span></a><button aria-label="Collapse sidebar category &#x27;Technical Papers&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/publications/technical-papers/continuous-authentication/"><span title="Deep Learning–Enabled Multimodal Continuous Authentication" class="categoryLinkLabel_W154">Deep Learning–Enabled Multimodal Continuous Authentication</span></a><button aria-label="Collapse sidebar category &#x27;Deep Learning–Enabled Multimodal Continuous Authentication&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/publications/technical-papers/continuous-authentication/01 abstract"><span title="Abstract" class="linkLabel_WmDU">Abstract</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/publications/technical-papers/continuous-authentication/02 problem-context"><span title="Problem Context" class="linkLabel_WmDU">Problem Context</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/publications/technical-papers/continuous-authentication/03 system-architecture"><span title="System Architecture" class="linkLabel_WmDU">System Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/publications/technical-papers/continuous-authentication/04 biometric-models-part1"><span title="Biometric Models: Physiological" class="linkLabel_WmDU">Biometric Models: Physiological</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/publications/technical-papers/continuous-authentication/05 biometric-models-part2"><span title="Biometric Models: Behavioral" class="linkLabel_WmDU">Biometric Models: Behavioral</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/publications/technical-papers/continuous-authentication/06 risk-classification"><span title="Risk Classification &amp; Decision Logic" class="linkLabel_WmDU">Risk Classification &amp; Decision Logic</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/publications/technical-papers/continuous-authentication/07 results-performance-analysis"><span title="Results &amp; Performance Analysis" class="linkLabel_WmDU">Results &amp; Performance Analysis</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/publications/technical-papers/continuous-authentication/08 conclusion-and-future-work"><span title="Conclusion &amp; Future Work" class="linkLabel_WmDU">Conclusion &amp; Future Work</span></a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/publications/technical-papers/"><span>Technical Papers</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/publications/technical-papers/continuous-authentication/"><span>Deep Learning–Enabled Multimodal Continuous Authentication</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Risk Classification &amp; Decision Logic</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Risk Classification &amp; Decision Logic</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>The Risk Classification module serves as the decision-making engine of the continuous authentication system. It integrates behavioral biometrics (keystroke dynamics and human activity recognition) with contextual parameters to assess the legitimacy of each user session. Based on this assessment, the system dynamically determines the appropriate level of verification required.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="feature-fusion-strategy">Feature Fusion Strategy<a href="#feature-fusion-strategy" class="hash-link" aria-label="Direct link to Feature Fusion Strategy" title="Direct link to Feature Fusion Strategy" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="multi-source-data-integration">Multi-Source Data Integration<a href="#multi-source-data-integration" class="hash-link" aria-label="Direct link to Multi-Source Data Integration" title="Direct link to Multi-Source Data Integration" translate="no">​</a></h3>
<p>The risk classifier receives inputs from multiple sources to create a comprehensive user profile:</p>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="feature-categories">Feature Categories<a href="#feature-categories" class="hash-link" aria-label="Direct link to Feature Categories" title="Direct link to Feature Categories" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-behavioral-features">1. Behavioral Features<a href="#1-behavioral-features" class="hash-link" aria-label="Direct link to 1. Behavioral Features" title="Direct link to 1. Behavioral Features" translate="no">​</a></h4>
<p><strong>Keystroke Dynamics:</strong></p>
<ul>
<li class="">Embedding vector from LSTM model (64 dimensions)</li>
<li class="">Average typing speed</li>
<li class="">Standard deviation of keystroke intervals</li>
<li class="">Digraph-specific patterns</li>
</ul>
<p><strong>Human Activity Recognition:</strong></p>
<ul>
<li class="">Predicted activity probabilities (6 classes)</li>
<li class="">Activity confidence score</li>
<li class="">Activity transition frequency</li>
<li class="">Movement intensity metrics</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-contextual-features">2. Contextual Features<a href="#2-contextual-features" class="hash-link" aria-label="Direct link to 2. Contextual Features" title="Direct link to 2. Contextual Features" translate="no">​</a></h4>
<table><thead><tr><th>Feature</th><th>Description</th><th>Risk Indicator</th></tr></thead><tbody><tr><td>IP Reputation</td><td>Fraud score from IP database (0-100)</td><td>Higher score = higher risk</td></tr><tr><td>Geolocation</td><td>Physical location from IP/GPS</td><td>Unusual location = risk</td></tr><tr><td>Geo Distance</td><td>Distance from typical locations</td><td>Large distance = risk</td></tr><tr><td>Device Fingerprint</td><td>Browser/device characteristics</td><td>Unknown device = risk</td></tr><tr><td>Fingerprint Match</td><td>Match with enrolled devices</td><td>No match = risk</td></tr></tbody></table>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-temporal-features">3. Temporal Features<a href="#3-temporal-features" class="hash-link" aria-label="Direct link to 3. Temporal Features" title="Direct link to 3. Temporal Features" translate="no">​</a></h4>
<table><thead><tr><th>Feature</th><th>Description</th><th>Anomaly Detection</th></tr></thead><tbody><tr><td>Login Time</td><td>Hour of day when login occurs</td><td>Unusual hours flagged</td></tr><tr><td>Login Frequency</td><td>Number of logins per day</td><td>Abnormal frequency detected</td></tr><tr><td>Session Duration</td><td>Time spent in session</td><td>Unusually short/long flagged</td></tr><tr><td>Time Since Last Login</td><td>Hours since previous session</td><td>Irregular patterns noted</td></tr><tr><td>Past Auth Failures</td><td>Recent failed attempts</td><td>Multiple failures = risk</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="feature-engineering">Feature Engineering<a href="#feature-engineering" class="hash-link" aria-label="Direct link to Feature Engineering" title="Direct link to Feature Engineering" translate="no">​</a></h3>
<p><strong>Derived Risk Indicators:</strong></p>
<!-- -->
<p><strong>Example Calculations:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Temporal Anomaly Detection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">calculate_anomaly_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Calculate z-score based on user&#x27;s historical behavior</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mean </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">std</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_history</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    z_score </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> mean</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">std </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1e-6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Flag as anomaly if beyond 2 standard deviations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    is_anomaly </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> z_score </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> z_score</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> is_anomaly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># IP Reputation Risk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_ip_risk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ip_address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Query IP reputation database</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Returns: fraud_score (0-100), location, risk_level</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reputation_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ip_reputation_api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ip_address</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;fraud_score&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> reputation_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;fraud_score&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;location&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> reputation_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;location&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;is_vpn&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> reputation_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;vpn_detected&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;is_proxy&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> reputation_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;proxy_detected&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="random-forest-classifier">Random Forest Classifier<a href="#random-forest-classifier" class="hash-link" aria-label="Direct link to Random Forest Classifier" title="Direct link to Random Forest Classifier" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="model-architecture">Model Architecture<a href="#model-architecture" class="hash-link" aria-label="Direct link to Model Architecture" title="Direct link to Model Architecture" translate="no">​</a></h3>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-random-forest">Why Random Forest?<a href="#why-random-forest" class="hash-link" aria-label="Direct link to Why Random Forest?" title="Direct link to Why Random Forest?" translate="no">​</a></h3>
<p><strong>Design Rationale:</strong></p>
<table><thead><tr><th>Advantage</th><th>Benefit</th><th>Application</th></tr></thead><tbody><tr><td>Ensemble Learning</td><td>Combines multiple weak learners</td><td>Robust predictions</td></tr><tr><td>Feature Importance</td><td>Identifies critical features</td><td>Interpretability</td></tr><tr><td>Non-linear Relationships</td><td>Captures complex patterns</td><td>Better risk detection</td></tr><tr><td>Handles Mixed Data</td><td>Works with numerical and categorical</td><td>Diverse feature types</td></tr><tr><td>Resistant to Overfitting</td><td>Averaging reduces variance</td><td>Generalizes well</td></tr><tr><td>Fast Inference</td><td>Parallel tree evaluation</td><td>Real-time classification</td></tr></tbody></table>
<p><strong>Comparison with Alternatives:</strong></p>
<table><thead><tr><th>Model</th><th>Accuracy</th><th>Interpretability</th><th>Speed</th><th>Robustness</th></tr></thead><tbody><tr><td>Logistic Regression</td><td>72%</td><td>High</td><td>Very Fast</td><td>Low</td></tr><tr><td>SVM</td><td>78%</td><td>Low</td><td>Moderate</td><td>Moderate</td></tr><tr><td>Neural Network</td><td>82%</td><td>Very Low</td><td>Slow</td><td>High</td></tr><tr><td>Random Forest</td><td>85%</td><td>Moderate</td><td>Fast</td><td>High</td></tr><tr><td>Gradient Boosting</td><td>87%</td><td>Moderate</td><td>Moderate</td><td>High</td></tr></tbody></table>
<p><strong>Selected: Random Forest</strong> - Best balance of accuracy, speed, and interpretability</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="model-configuration">Model Configuration<a href="#model-configuration" class="hash-link" aria-label="Direct link to Model Configuration" title="Direct link to Model Configuration" translate="no">​</a></h3>
<p><strong>Hyperparameters:</strong></p>
<table><thead><tr><th>Parameter</th><th>Value</th><th>Rationale</th></tr></thead><tbody><tr><td>Number of Trees</td><td>100</td><td>Balance between performance and speed</td></tr><tr><td>Max Depth</td><td>10</td><td>Prevent overfitting while capturing patterns</td></tr><tr><td>Min Samples Split</td><td>5</td><td>Ensure sufficient data at each split</td></tr><tr><td>Min Samples Leaf</td><td>2</td><td>Allow fine-grained decisions</td></tr><tr><td>Max Features</td><td>sqrt(n_features)</td><td>Reduce correlation between trees</td></tr><tr><td>Bootstrap</td><td>True</td><td>Sample with replacement for diversity</td></tr><tr><td>Class Weight</td><td>Balanced</td><td>Handle imbalanced risk levels</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="training-process">Training Process<a href="#training-process" class="hash-link" aria-label="Direct link to Training Process" title="Direct link to Training Process" translate="no">​</a></h3>
<p><strong>Dataset Preparation:</strong></p>
<!-- -->
<p><strong>Training Configuration:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ensemble </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> RandomForestClassifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initialize model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rf_classifier </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> RandomForestClassifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    n_estimators</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max_depth</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_samples_split</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_samples_leaf</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max_features</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;sqrt&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bootstrap</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    class_weight</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;balanced&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    random_state</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    n_jobs</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Use all CPU cores</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Train with cross-validation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cross_val_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cv_scores </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cross_val_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rf_classifier</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cv</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scoring</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;accuracy&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;CV Accuracy: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">cv_scores</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">mean</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> (+/- </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">cv_scores</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">std</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="feature-importance-analysis">Feature Importance Analysis<a href="#feature-importance-analysis" class="hash-link" aria-label="Direct link to Feature Importance Analysis" title="Direct link to Feature Importance Analysis" translate="no">​</a></h3>
<p>The Random Forest model provides insights into which features contribute most to risk assessment:</p>
<!-- -->
<p><strong>Key Insights:</strong></p>
<ol>
<li class="">
<p><strong>Network-based features dominate</strong> (IP reputation, geolocation)</p>
<ul>
<li class="">These provide strong signals for detecting compromised accounts</li>
<li class="">Known malicious IPs are highly predictive</li>
</ul>
</li>
<li class="">
<p><strong>Behavioral history matters</strong> (past failures, login patterns)</p>
<ul>
<li class="">Recent authentication failures strongly indicate risk</li>
<li class="">Historical patterns establish baseline</li>
</ul>
</li>
<li class="">
<p><strong>Biometric features are supplementary</strong> (keystroke, activity)</p>
<ul>
<li class="">Provide continuous verification during session</li>
<li class="">Act as tiebreakers for ambiguous cases</li>
<li class="">More important for session continuity than initial assessment</li>
</ul>
</li>
</ol>
<p><strong>Feature Importance Table:</strong></p>
<table><thead><tr><th>Rank</th><th>Feature</th><th>Importance</th><th>Category</th></tr></thead><tbody><tr><td>1</td><td>IP Reputation Flag</td><td>25.3%</td><td>Contextual</td></tr><tr><td>2</td><td>Past Auth Failures</td><td>18.7%</td><td>Temporal</td></tr><tr><td>3</td><td>Geo Distance Risk</td><td>14.2%</td><td>Contextual</td></tr><tr><td>4</td><td>Stored IP Match</td><td>8.9%</td><td>Contextual</td></tr><tr><td>5</td><td>Fingerprint Match</td><td>7.6%</td><td>Contextual</td></tr><tr><td>6</td><td>Time Anomaly</td><td>6.4%</td><td>Temporal</td></tr><tr><td>7</td><td>Session Duration Anomaly</td><td>5.3%</td><td>Temporal</td></tr><tr><td>8</td><td>Login Frequency Anomaly</td><td>4.7%</td><td>Temporal</td></tr><tr><td>9</td><td>Keystroke Risk</td><td>3.2%</td><td>Behavioral</td></tr><tr><td>10</td><td>Activity Anomaly</td><td>2.8%</td><td>Behavioral</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="risk-level-classification">Risk Level Classification<a href="#risk-level-classification" class="hash-link" aria-label="Direct link to Risk Level Classification" title="Direct link to Risk Level Classification" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="three-tier-risk-system">Three-Tier Risk System<a href="#three-tier-risk-system" class="hash-link" aria-label="Direct link to Three-Tier Risk System" title="Direct link to Three-Tier Risk System" translate="no">​</a></h3>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="risk-level-definitions">Risk Level Definitions<a href="#risk-level-definitions" class="hash-link" aria-label="Direct link to Risk Level Definitions" title="Direct link to Risk Level Definitions" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="low-risk-confidence--80">Low Risk (Confidence &gt; 80%)<a href="#low-risk-confidence--80" class="hash-link" aria-label="Direct link to Low Risk (Confidence &gt; 80%)" title="Direct link to Low Risk (Confidence &gt; 80%)" translate="no">​</a></h4>
<p><strong>Characteristics:</strong></p>
<ul>
<li class="">All features align with user&#x27;s historical profile</li>
<li class="">Known device and IP address</li>
<li class="">Normal login time and location</li>
<li class="">Keystroke and activity patterns match baseline</li>
<li class="">No recent authentication failures</li>
</ul>
<p><strong>System Action:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> risk_level </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;low&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Continue session without interruption</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_event</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;session_continued&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;continue&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;message&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Session verified&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;confidence&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> confidence_score</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>User Experience:</strong></p>
<ul>
<li class="">Seamless access</li>
<li class="">No additional verification required</li>
<li class="">Background monitoring continues</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="medium-risk-confidence-50-80">Medium Risk (Confidence 50-80%)<a href="#medium-risk-confidence-50-80" class="hash-link" aria-label="Direct link to Medium Risk (Confidence 50-80%)" title="Direct link to Medium Risk (Confidence 50-80%)" translate="no">​</a></h4>
<p><strong>Characteristics:</strong></p>
<ul>
<li class="">Minor deviations from typical behavior</li>
<li class="">Examples:<!-- -->
<ul>
<li class="">Unusual login time (but from known location)</li>
<li class="">Known device but different IP</li>
<li class="">Slight variation in keystroke patterns</li>
<li class="">Activity pattern partially matches</li>
</ul>
</li>
</ul>
<p><strong>System Action:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> risk_level </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;medium&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Trigger voice verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_event</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;voice_verification_required&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    voice_result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> request_voice_verification</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> voice_result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;verified&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;continue&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;method&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;voice_verified&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Escalate to face verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;escalate_to_face&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;reason&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;voice_failed&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>User Experience:</strong></p>
<ul>
<li class="">Prompted for voice verification</li>
<li class="">Brief interruption (5-10 seconds)</li>
<li class="">If voice matches, session continues</li>
<li class="">If voice fails, escalates to face check</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="high-risk-confidence--50">High Risk (Confidence &lt; 50%)<a href="#high-risk-confidence--50" class="hash-link" aria-label="Direct link to High Risk (Confidence &lt; 50%)" title="Direct link to High Risk (Confidence &lt; 50%)" translate="no">​</a></h4>
<p><strong>Characteristics:</strong></p>
<ul>
<li class="">Significant anomalies detected</li>
<li class="">Examples:<!-- -->
<ul>
<li class="">Unknown device or IP</li>
<li class="">Suspicious geolocation</li>
<li class="">Multiple recent failures</li>
<li class="">Keystroke/activity pattern mismatch</li>
<li class="">Access from flagged IP</li>
</ul>
</li>
</ul>
<p><strong>System Action:</strong></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> risk_level </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;high&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Require face verification immediately</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_event</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;face_verification_required&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    face_result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> request_face_verification</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> face_result</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;verified&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Update trust score</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        update_user_trust_score</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;increase&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;continue&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;method&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;face_verified&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Deny access and trigger security alert</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        deny_access</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        send_security_alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> session_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;action&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;deny&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;reason&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;face_verification_failed&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>User Experience:</strong></p>
<ul>
<li class="">Immediate face verification required</li>
<li class="">Session paused until verification</li>
<li class="">If face matches, access granted</li>
<li class="">If face fails, access denied and user notified</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="threshold-tuning">Threshold Tuning<a href="#threshold-tuning" class="hash-link" aria-label="Direct link to Threshold Tuning" title="Direct link to Threshold Tuning" translate="no">​</a></h3>
<p><strong>Probability-to-Risk Mapping:</strong></p>
<!-- -->
<p><strong>Threshold Optimization:</strong></p>
<p>The thresholds were determined through:</p>
<ol>
<li class="">ROC curve analysis</li>
<li class="">Precision-recall trade-off evaluation</li>
<li class="">Business requirements (acceptable friction level)</li>
<li class="">False positive/negative cost analysis</li>
</ol>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">classify_risk</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">probability_scores</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Convert model probabilities to risk levels</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    probability_scores: Array of [P(low), P(medium), P(high)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    predicted_class </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">probability_scores</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    confidence </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> probability_scores</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">predicted_class</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Apply confidence thresholds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> predicted_class </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> confidence </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.80</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;low&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> confidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> predicted_class </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.50</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> confidence </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.80</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;medium&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> confidence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;high&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> confidence</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="decision-flow-implementation">Decision Flow Implementation<a href="#decision-flow-implementation" class="hash-link" aria-label="Direct link to Decision Flow Implementation" title="Direct link to Decision Flow Implementation" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="complete-authentication-workflow">Complete Authentication Workflow<a href="#complete-authentication-workflow" class="hash-link" aria-label="Direct link to Complete Authentication Workflow" title="Direct link to Complete Authentication Workflow" translate="no">​</a></h3>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="adaptive-threshold-adjustment">Adaptive Threshold Adjustment<a href="#adaptive-threshold-adjustment" class="hash-link" aria-label="Direct link to Adaptive Threshold Adjustment" title="Direct link to Adaptive Threshold Adjustment" translate="no">​</a></h3>
<p>The system can dynamically adjust risk thresholds based on:</p>
<!-- -->
<p><strong>Example Adjustments:</strong></p>
<table><thead><tr><th>Condition</th><th>Threshold Modification</th><th>Rationale</th></tr></thead><tbody><tr><td>Admin Account</td><td>-10% on all thresholds</td><td>Higher security required</td></tr><tr><td>Recent Breach Alert</td><td>-15% on all thresholds</td><td>Temporarily increase scrutiny</td></tr><tr><td>Peak Business Hours</td><td>+5% on low threshold</td><td>Reduce friction during busy times</td></tr><tr><td>After-hours Access</td><td>-10% on all thresholds</td><td>Unusual timing increases risk</td></tr><tr><td>High-value Transaction</td><td>-20% on all thresholds</td><td>Protect sensitive operations</td></tr></tbody></table>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">adjust_thresholds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base_thresholds</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Dynamically adjust risk thresholds based on context</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    adjusted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base_thresholds</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Account type adjustment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;is_admin&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adjusted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.10</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> t </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> adjusted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Security event adjustment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;recent_breach_alert&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adjusted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.15</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> t </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> adjusted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Time-based adjustment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;is_business_hours&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adjusted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.10</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> t </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> adjusted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Transaction value adjustment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;high_value_operation&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        adjusted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.20</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> t </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> adjusted</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> adjusted</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="continuous-feedback-loop">Continuous Feedback Loop<a href="#continuous-feedback-loop" class="hash-link" aria-label="Direct link to Continuous Feedback Loop" title="Direct link to Continuous Feedback Loop" translate="no">​</a></h3>
<p>The system learns and improves over time:</p>
<!-- -->
<p><strong>Feedback Mechanisms:</strong></p>
<ol>
<li class="">
<p><strong>Trust Score Updates:</strong></p>
<ul>
<li class="">Successful verifications increase trust</li>
<li class="">Failed verifications decrease trust</li>
<li class="">Trust score influences future risk assessments</li>
</ul>
</li>
<li class="">
<p><strong>Pattern Learning:</strong></p>
<ul>
<li class="">New behavioral patterns are added to user profile</li>
<li class="">Outdated patterns are gradually phased out</li>
<li class="">Model adapts to legitimate behavior changes</li>
</ul>
</li>
<li class="">
<p><strong>False Positive Handling:</strong></p>
<ul>
<li class="">User can report false alarms</li>
<li class="">System adjusts sensitivity for that user</li>
<li class="">Collective feedback improves model</li>
</ul>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="performance-metrics">Performance Metrics<a href="#performance-metrics" class="hash-link" aria-label="Direct link to Performance Metrics" title="Direct link to Performance Metrics" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="classification-performance">Classification Performance<a href="#classification-performance" class="hash-link" aria-label="Direct link to Classification Performance" title="Direct link to Classification Performance" translate="no">​</a></h3>
<p><strong>Overall Metrics:</strong></p>
<table><thead><tr><th>Metric</th><th>Value</th><th>Evaluation</th></tr></thead><tbody><tr><td>Accuracy</td><td>85.2%</td><td>Strong overall performance</td></tr><tr><td>Precision (weighted)</td><td>84.7%</td><td>Low false positive rate</td></tr><tr><td>Recall (weighted)</td><td>85.2%</td><td>Good detection of risky sessions</td></tr><tr><td>F1-Score (weighted)</td><td>84.9%</td><td>Balanced performance</td></tr><tr><td>ROC-AUC (macro)</td><td>0.91</td><td>Excellent discrimination</td></tr></tbody></table>
<p><strong>Per-Class Performance:</strong></p>
<table><thead><tr><th>Risk Level</th><th>Precision</th><th>Recall</th><th>F1-Score</th><th>Support</th></tr></thead><tbody><tr><td>Low</td><td>88.3%</td><td>92.1%</td><td>90.1%</td><td>3,240</td></tr><tr><td>Medium</td><td>79.8%</td><td>73.6%</td><td>76.6%</td><td>1,820</td></tr><tr><td>High</td><td>87.1%</td><td>89.4%</td><td>88.2%</td><td>940</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="real-world-performance">Real-World Performance<a href="#real-world-performance" class="hash-link" aria-label="Direct link to Real-World Performance" title="Direct link to Real-World Performance" translate="no">​</a></h3>
<p><strong>Session Processing:</strong></p>
<table><thead><tr><th>Metric</th><th>Value</th><th>Target</th></tr></thead><tbody><tr><td>Average Latency</td><td>127ms</td><td>&lt; 200ms</td></tr><tr><td>95th Percentile Latency</td><td>189ms</td><td>&lt; 250ms</td></tr><tr><td>Throughput</td><td>450 requests/sec</td><td>&gt; 400/sec</td></tr><tr><td>Memory Usage</td><td>340MB</td><td>&lt; 500MB</td></tr></tbody></table>
<p><strong>User Experience Impact:</strong></p>
<!-- -->
<p><strong>Observations:</strong></p>
<ul>
<li class="">72.5% of sessions proceed without interruption</li>
<li class="">21.3% require voice verification (minimal friction)</li>
<li class="">Only 6.2% require face verification (higher friction)</li>
<li class="">Overall user friction is acceptable</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="error-analysis">Error Analysis<a href="#error-analysis" class="hash-link" aria-label="Direct link to Error Analysis" title="Direct link to Error Analysis" translate="no">​</a></h3>
<p><strong>False Positives (Legitimate User Flagged):</strong></p>
<ul>
<li class="">Rate: 8.7% of low-risk sessions</li>
<li class="">Primary causes:<!-- -->
<ul>
<li class="">Travel to new locations</li>
<li class="">Using new devices</li>
<li class="">Temporary behavior changes (illness, fatigue)</li>
</ul>
</li>
<li class="">Mitigation: User can verify and update profile</li>
</ul>
<p><strong>False Negatives (Attacker Not Detected):</strong></p>
<ul>
<li class="">Rate: 3.2% of high-risk sessions</li>
<li class="">Primary causes:<!-- -->
<ul>
<li class="">Sophisticated mimicry of behavior</li>
<li class="">Stolen device with recent biometric data</li>
<li class="">Zero-day attack patterns</li>
</ul>
</li>
<li class="">Mitigation: Multi-factor verification, anomaly detection</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="attack-resistance">Attack Resistance<a href="#attack-resistance" class="hash-link" aria-label="Direct link to Attack Resistance" title="Direct link to Attack Resistance" translate="no">​</a></h3>
<p><strong>Protection Against:</strong></p>
<ol>
<li class="">
<p><strong>Replay Attacks</strong>:</p>
<ul>
<li class="">Timestamp validation</li>
<li class="">Session token rotation</li>
<li class="">Behavioral pattern diversity</li>
</ul>
</li>
<li class="">
<p><strong>Mimicry Attacks</strong>:</p>
<ul>
<li class="">Multi-modal verification</li>
<li class="">Temporal pattern analysis</li>
<li class="">Liveness detection</li>
</ul>
</li>
<li class="">
<p><strong>Stolen Credentials</strong>:</p>
<ul>
<li class="">Behavioral mismatch detection</li>
<li class="">Device fingerprinting</li>
<li class="">Geolocation validation</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="privacy-and-compliance">Privacy and Compliance<a href="#privacy-and-compliance" class="hash-link" aria-label="Direct link to Privacy and Compliance" title="Direct link to Privacy and Compliance" translate="no">​</a></h3>
<p><strong>Data Protection:</strong></p>
<ul>
<li class="">Biometric embeddings stored (not raw data)</li>
<li class="">Encryption at rest and in transit</li>
<li class="">User consent required for enrollment</li>
<li class="">Right to delete biometric data</li>
</ul>
<p><strong>GDPR Compliance:</strong></p>
<ul>
<li class="">Explicit consent for biometric processing</li>
<li class="">Clear purpose limitation</li>
<li class="">Data minimization principles</li>
<li class="">Audit trail for all decisions</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="future-enhancements">Future Enhancements<a href="#future-enhancements" class="hash-link" aria-label="Direct link to Future Enhancements" title="Direct link to Future Enhancements" translate="no">​</a></h2>
<p><strong>Planned Improvements:</strong></p>
<ol>
<li class="">
<p><strong>Advanced ML Models</strong>:</p>
<ul>
<li class="">Deep neural networks for feature fusion</li>
<li class="">Gradient boosting for improved accuracy</li>
<li class="">Online learning for real-time adaptation</li>
</ul>
</li>
<li class="">
<p><strong>Extended Features</strong>:</p>
<ul>
<li class="">Mouse dynamics patterns</li>
<li class="">Touch pressure and gestures</li>
<li class="">Application usage sequences</li>
<li class="">Network traffic patterns</li>
</ul>
</li>
<li class="">
<p><strong>Explainable AI</strong>:</p>
<ul>
<li class="">SHAP values for decision transparency</li>
<li class="">User-friendly risk explanations</li>
<li class="">Compliance reporting automation</li>
</ul>
</li>
<li class="">
<p><strong>Adaptive Learning</strong>:</p>
<ul>
<li class="">Personalized risk thresholds per user</li>
<li class="">Continuous model retraining</li>
<li class="">Transfer learning from similar users</li>
</ul>
</li>
</ol>
<hr></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/publications/technical-papers/continuous-authentication/05 biometric-models-part2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Biometric Models: Behavioral</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/publications/technical-papers/continuous-authentication/07 results-performance-analysis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Results &amp; Performance Analysis</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#feature-fusion-strategy" class="table-of-contents__link toc-highlight">Feature Fusion Strategy</a><ul><li><a href="#multi-source-data-integration" class="table-of-contents__link toc-highlight">Multi-Source Data Integration</a></li><li><a href="#feature-categories" class="table-of-contents__link toc-highlight">Feature Categories</a></li><li><a href="#feature-engineering" class="table-of-contents__link toc-highlight">Feature Engineering</a></li></ul></li><li><a href="#random-forest-classifier" class="table-of-contents__link toc-highlight">Random Forest Classifier</a><ul><li><a href="#model-architecture" class="table-of-contents__link toc-highlight">Model Architecture</a></li><li><a href="#why-random-forest" class="table-of-contents__link toc-highlight">Why Random Forest?</a></li><li><a href="#model-configuration" class="table-of-contents__link toc-highlight">Model Configuration</a></li><li><a href="#training-process" class="table-of-contents__link toc-highlight">Training Process</a></li><li><a href="#feature-importance-analysis" class="table-of-contents__link toc-highlight">Feature Importance Analysis</a></li></ul></li><li><a href="#risk-level-classification" class="table-of-contents__link toc-highlight">Risk Level Classification</a><ul><li><a href="#three-tier-risk-system" class="table-of-contents__link toc-highlight">Three-Tier Risk System</a></li><li><a href="#risk-level-definitions" class="table-of-contents__link toc-highlight">Risk Level Definitions</a></li><li><a href="#threshold-tuning" class="table-of-contents__link toc-highlight">Threshold Tuning</a></li></ul></li><li><a href="#decision-flow-implementation" class="table-of-contents__link toc-highlight">Decision Flow Implementation</a><ul><li><a href="#complete-authentication-workflow" class="table-of-contents__link toc-highlight">Complete Authentication Workflow</a></li><li><a href="#adaptive-threshold-adjustment" class="table-of-contents__link toc-highlight">Adaptive Threshold Adjustment</a></li><li><a href="#continuous-feedback-loop" class="table-of-contents__link toc-highlight">Continuous Feedback Loop</a></li></ul></li><li><a href="#performance-metrics" class="table-of-contents__link toc-highlight">Performance Metrics</a><ul><li><a href="#classification-performance" class="table-of-contents__link toc-highlight">Classification Performance</a></li><li><a href="#real-world-performance" class="table-of-contents__link toc-highlight">Real-World Performance</a></li><li><a href="#error-analysis" class="table-of-contents__link toc-highlight">Error Analysis</a></li></ul></li><li><a href="#security-considerations" class="table-of-contents__link toc-highlight">Security Considerations</a><ul><li><a href="#attack-resistance" class="table-of-contents__link toc-highlight">Attack Resistance</a></li><li><a href="#privacy-and-compliance" class="table-of-contents__link toc-highlight">Privacy and Compliance</a></li></ul></li><li><a href="#future-enhancements" class="table-of-contents__link toc-highlight">Future Enhancements</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Site</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/engineering">Engineering</a></li><li class="footer__item"><a class="footer__link-item" href="/publications">Publications</a></li><li class="footer__item"><a class="footer__link-item" href="/resume">Resume</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/anubhab-codes" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/anubhab-ghosh/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://lichess.org/@/ravenclaw_x" target="_blank" rel="noopener noreferrer" class="footer__link-item">Lichess<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Anubhab Ghosh.</div></div></div></footer></div>
</body>
</html>